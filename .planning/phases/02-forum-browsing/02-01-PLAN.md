---
phase: 02-forum-browsing
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - nga_app/lib/screens/forum_screen.dart
autonomous: true
must_haves:
  truths:
    - User sees visual guidance to open drawer when no board is selected
    - Empty state is not confusing "暂无内容" message
    - User understands they need to select a board to see threads
  artifacts:
    - path: nga_app/lib/screens/forum_screen.dart
      provides: "Empty state with drawer CTA"
      min_lines: 30
  key_links:
    - from: ForumContent._buildBody()
      to: "Drawer open hint"
      via: "Empty state widget with button"
---

<objective>
Improve the ForumContent empty state to guide users toward the drawer navigation.

Purpose: Users currently see "暂无内容，选择版块后会显示主题列表" which is confusing. The empty state should clearly indicate that opening the drawer (left menu) will let them select a board.

Output: Updated ForumContent with clear empty state guidance including:
- Icon indicating no board selected
- Clear text explaining to open drawer
- Tappable button or hint to open drawer
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@./.planning/ROADMAP.md
@nga_app/lib/screens/forum_screen.dart
@nga_app/lib/screens/home_screen.dart
</context>

<tasks>

<task type="auto">
  <name>Replace empty state with guiding widget</name>
  <files>nga_app/lib/screens/forum_screen.dart</files>
  <action>
    Locate the `_buildBody()` method in `_ForumContentState`. Find this line:
    ```dart
    if (_threads.isEmpty) {
      return const Center(child: Text('暂无内容，选择版块后会显示主题列表。'));
    }
    ```

    Replace the empty state with a guiding widget that:
    1. Shows an icon (menu or forum icon) sized 64x64
    2. Shows primary text: "请从侧边栏选择版块"
    3. Shows secondary text: "点击左上角菜单图标打开版块列表"
    4. Includes a tappable "打开菜单" button that calls `_openMenuDrawer()`

    Reference home_screen.dart for `_openMenuDrawer` pattern (ScaffoldState.openDrawer).

    Keep the existing thread list rendering logic intact.
  </action>
  <verify>flutter analyze passes and empty state shows guidance UI</verify>
  <done>Empty state displays "请从侧边栏选择版块" with open menu button</done>
</task>

<task type="auto">
  <name>Add drawer open method reference</name>
  <files>nga_app/lib/screens/forum_screen.dart</files>
  <action>
    Add a GlobalKey for ScaffoldState to ForumContent widget so it can open the drawer:

    1. Add `final GlobalKey<ScaffoldState> _scaffoldKey = GlobalKey<ScaffoldState>();` to `_ForumContentState`
    2. Add `key: _scaffoldKey` to the Scaffold in `_buildBody()` (note: ForumContent is embedded in HomeScreen's Scaffold, so this needs a different approach)

    Actually, ForumContent is embedded within HomeScreen's Scaffold body. Instead of using Scaffold key, add a method that uses `Scaffold.of(context).openDrawer()` wrapped in try/catch to handle the case when not in scaffold context.

    Add:
    ```dart
    void _openDrawer() {
      try {
        Scaffold.of(context).openDrawer();
      } catch (e) {
        // Not in scaffold context, ignore
      }
    }
    ```

    Use this in the empty state button's onPressed.
  </action>
  <verify>flutter analyze passes and button tap attempts to open drawer</verify>
  <done>Empty state button can trigger drawer open</done>
</task>

</tasks>

<verification>
1. Run `cd nga_app && fvm flutter analyze` - no errors
2. App starts and shows empty state with guidance
3. Tapping "打开菜单" button opens the drawer
</verification>

<success_criteria>
- [ ] Empty state shows clear guidance text and icon
- [] "打开菜单" button opens the left drawer
- [ ] flutter analyze passes
</success_criteria>

<output>
After completion, create `.planning/phases/02-forum-browsing/02-01-SUMMARY.md`
</output>
